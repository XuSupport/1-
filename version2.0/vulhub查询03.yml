app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: vulhubæŸ¥è¯¢03
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/deepseek:0.0.6@dd589dc093c8084925858034ab5ec1fdf0d33819f43226c2f8c4a749a9acbbb2
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables:
  - description: ''
    id: c4e9baac-aeda-4d8e-b0dc-63127a2c1503
    name: API_KEY
    selector:
    - env
    - API_KEY
    value: e62a9b0d239d3f6fe2f203c5bede453c
    value_type: string
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1753066202455-source-1753066204386-target
      source: '1753066202455'
      sourceHandle: source
      target: '1753066204386'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1753066204386-source-1753066242086-target
      source: '1753066204386'
      sourceHandle: source
      target: '1753066242086'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1753066242086-source-1753066670827-target
      source: '1753066242086'
      sourceHandle: source
      target: '1753066670827'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: end
      id: 1753066670827-source-1753066281243-target
      source: '1753066670827'
      sourceHandle: source
      target: '1753066281243'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: input
          max_length: 256
          options: []
          required: true
          type: text-input
          variable: input
      height: 90
      id: '1753066202455'
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1753066202455'
          - input
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: f1a9dd96-554e-40ca-9910-d9bf2240d31f
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ¼æ´åˆ†æåŠ©æ‰‹ã€‚ä½ çš„ä»»åŠ¡æ˜¯åˆ†æç”¨æˆ·çš„è¾“å…¥{{#1753066202455.input#}}ï¼Œè¯†åˆ«å…¶ä¸­åŒ…å«çš„CVEæˆ–æ¼æ´ç¼–å·ï¼ˆä¾‹å¦‚â€œCVE-XXXX-XXXXXâ€æˆ–â€œCNVD-YYYY-YYYYYâ€æ ¼å¼ï¼‰ï¼Œå¹¶ä»…è¾“å‡ºè¯†åˆ«å‡ºçš„ç²¾ç¡®æ¼æ´åç§°ã€‚å¦‚æœè¾“å…¥ä¸­åŒ…å«å¤šä¸ªæ¼æ´åç§°ï¼Œé€è¡Œè¾“å‡ºæ‰€æœ‰è¯†åˆ«å‡ºçš„åç§°ã€‚å¦‚æœæ²¡æœ‰è¯†åˆ«å‡ºæ¼æ´åç§°ï¼Œåˆ™è¿”å›â€œæ— æ¼æ´åç§°â€ã€‚\n\
            \nç¤ºä¾‹ï¼š\n- è¾“å…¥ï¼šè¯·å¸®æˆ‘æŸ¥æ‰¾CVE-2021-43008çš„æ¼æ´ç¯å¢ƒ\n  è¾“å‡ºï¼šCVE-2021-43008\n\n- è¾“å…¥ï¼šæˆ‘æƒ³äº†è§£CVE-2022-12345å’ŒCNVD-2023-67890\n\
            \  è¾“å‡ºï¼šCVE-2022-12345\n  CNVD-2023-67890\n\n- è¾“å…¥ï¼šä½ å¥½ï¼Œæˆ‘æƒ³å­¦ä¹ Python\n  è¾“å‡ºï¼šæ— æ¼æ´åç§°"
        selected: false
        title: vulhubå¯¹æ¯”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1753066204386'
      position:
        x: 386
        y: 282
      positionAbsolute:
        x: 386
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import requests\n\ndef main(input: str, API_KEY: str) -> dict:\n  \
          \  # MCPæœåŠ¡åœ°å€ï¼Œéœ€æ›¿æ¢ä¸ºå®é™…è¿œç¨‹æœåŠ¡å™¨åœ°å€\n    mcp_url = \"http://172.17.0.1:8005/search_cve\"\
          \n    \n    # æ·»åŠ APIå¯†é’¥åˆ°è¯·æ±‚å¤´\n    headers = {}\n    if API_KEY:\n        headers[\"\
          X-API-Key\"] = API_KEY\n\n    try:\n        # å‘é€POSTè¯·æ±‚åˆ°MCPæœåŠ¡ï¼Œä¼ é€’è¾“å…¥çš„CVEï¼Œæ·»åŠ è®¤è¯å¤´\n\
          \        response = requests.post(mcp_url, json={\"cve\": input.strip()},\
          \ headers=headers)\n        response.raise_for_status()  # æŠ›å‡ºå¼‚å¸¸å¦‚æœè¯·æ±‚å¤±è´¥\n\
          \        \n        result = response.json()\n        if result[\"status\"\
          ] == \"success\":\n            return {\"result\": f\"æ‰¾åˆ°CVEè·¯å¾„: {result['path']}\"\
          }\n        else:\n            return {\"result\": f\"é”™è¯¯: {result['message']}\"\
          }\n    \n    except requests.exceptions.RequestException as e:\n       \
          \ return {\"result\": f\"è¯·æ±‚MCPæœåŠ¡å¤±è´¥: {str(e)}\"}"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æœå¯»cve
        type: code
        variables:
        - value_selector:
          - '1753066204386'
          - text
          value_type: string
          variable: input
        - value_selector:
          - env
          - API_KEY
          value_type: string
          variable: API_KEY
      height: 54
      id: '1753066242086'
      position:
        x: 690
        y: 282
      positionAbsolute:
        x: 690
        y: 282
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1753066670827'
          - result
          value_type: string
          variable: result
        selected: false
        title: ç»“æŸ
        type: end
      height: 90
      id: '1753066281243'
      position:
        x: 1441
        y: 282
      positionAbsolute:
        x: 1441
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import requests\nimport re\n\ndef main(input: str, API_KEY: str) ->\
          \ dict:\n    # æå–CVEè·¯å¾„\n    path_match = re.search(r\"æ‰¾åˆ°CVEè·¯å¾„: (.+)\", input)\n\
          \    if not path_match:\n        return {\"result\": \"é”™è¯¯: æ— æ³•æå–CVEè·¯å¾„\"}\n\
          \n    cve_path = path_match.group(1)\n    cve_name = cve_path.split(\"/\"\
          )[-1]  # æå–CVEç¼–å·ï¼Œå¦‚CVE-2021-43008\n\n    # MCPæœåŠ¡åœ°å€ï¼Œéœ€æ›¿æ¢ä¸ºå®é™…è¿œç¨‹æœåŠ¡å™¨åœ°å€\n    mcp_url\
          \ = \"http://172.17.0.1:8005/run_docker\"\n    \n    # æ·»åŠ APIå¯†é’¥åˆ°è¯·æ±‚å¤´\n   \
          \ headers = {}\n    if API_KEY:\n        headers[\"X-API-Key\"] = API_KEY\n\
          \n    try:\n        # å‘é€POSTè¯·æ±‚åˆ°MCPæœåŠ¡ï¼Œä¼ é€’CVEç¼–å·ï¼Œæ·»åŠ è®¤è¯å¤´\n        response = requests.post(mcp_url,\
          \ json={\"cve\": cve_name}, headers=headers)\n        response.raise_for_status()\
          \  # æŠ›å‡ºå¼‚å¸¸å¦‚æœè¯·æ±‚å¤±è´¥\n        \n        result = response.json()\n        if\
          \ result[\"status\"] == \"accepted\":\n            return {\"result\": f\"\
          è¯·æ±‚å·²æ¥å—ï¼Œ{cve_name} çš„Dockerç¯å¢ƒæ­£åœ¨å¯åŠ¨\"}\n        else:\n            return {\"\
          result\": f\"é”™è¯¯: {result['message']}\"}\n    \n    except requests.exceptions.RequestException\
          \ as e:\n        return {\"result\": f\"è¯·æ±‚MCPæœåŠ¡å¤±è´¥: {str(e)}\"}"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å¼€å¯cve
        type: code
        variables:
        - value_selector:
          - '1753066242086'
          - result
          value_type: string
          variable: input
        - value_selector:
          - env
          - API_KEY
          value_type: string
          variable: API_KEY
      height: 54
      id: '1753066670827'
      position:
        x: 1082.8311388837926
        y: 282
      positionAbsolute:
        x: 1082.8311388837926
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -361.19907209464577
      y: 155.2405012316385
      zoom: 0.8555336353772525
